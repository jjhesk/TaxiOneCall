var IOSSearchAPI={};jQuery(function(e){IOSSearchAPI=function(t,a){this.store_id=e("#store_id"),this.textdesc=e("#desc_area"),this.icon_url=e("#icon_url"),this.name_component=t,this.app_name=e("#app_name"),this.ios_slicker=a,this.ios_search_app=e("#search_app"),this.ios_row_search_app=e("#ios_row_search_app"),this.init()},IOSSearchAPI.prototype={init:function(){var t=this;t.init_select_module(),e(".bigdrop").css({max_height:500}),e("ul.select2-results").css({"max-height":450})},enable:function(e){var t=this;e?(t.ios_row_search_app.removeClass("hidden"),t.ios_slicker.clear()):t.ios_row_search_app.addClass("hidden")},setOnChange:function(e){this.ios_search_app.on("change",e)},init_select_module:function(){var t=this;t.select2module=e("#"+t.name_component).select2({fragmentPlatform:Handlebars.compile(e("#t_ios").html()),placeholder:"Search for an app",minimumInputLength:2,id:function(e){return{id:e._id}},ajax:{url:"https://itunes.apple.com/search/",dataType:"jsonp",data:function(e){return{term:e,entity:"software",limit:30}},results:function(e){return console.log(e),{results:e.results}}},initSelection:function(e,t){var a={id:e.val(),text:e.val()};t(a),console.log(a)},selectOnBlur:!0,formatResult:t.parseFormat,formatSelection:t.parseFormatSelection,dropdownCssClass:"bigdrop",closeOnSelect:!0,multiple:!1,escapeMarkup:function(e){return e}}),t.select2module.on("select2-selecting",{that:t},t.fill_in_app_data)},fill_in_app_data:function(e){var t=e.data.that;t.ios_slicker.clear(),t.app_name.val(JSON.stringify(e.choice.trackName).replace(/"/g,"")),t.store_id.val(JSON.stringify(e.choice.trackId)),t.icon_url.val(JSON.stringify(e.choice.artworkUrl60).replace(/"/g,"")),t.textdesc.val(JSON.stringify(e.choice.description).replace(/"/g,"").replace(/\\n/g," ").replace(/\\/g,"")),t.ios_slicker.append(e.choice.screenshotUrls)},parseFormat:function(e){var t=this,a="<table class='result_table_listing'>",i=t.fragmentPlatform;return void 0!==e.trackName&&void 0!==e.trackId&&(a+=i(e)),a+="</table>"},parseFormatSelection:function(t){return e("#search_app").val(t.bundleId),t.bundleId}}});